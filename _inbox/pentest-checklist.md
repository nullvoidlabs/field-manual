# _inbox/pentest-checklist.md

- `unix/permissions-and-privesc.md`
- `unix/file-discovery.md`

## Objective

### Enumeration and Fingerprinting Checklist

#### 1. Information Gathering & Scoping
- [x] Confirm engagement scope and authorized targets
- [ ] Identify any in-scope IP ranges, domains, and subdomains
- [ ] Review any provided network diagrams, architecture documents, or system details
- [ ] Check any allowed tool or payload restrictions

---

### 2. Reconnaissance (External)

#### Passive Recon
- [x] WHOIS information on domains/IPs
- [ ] Reverse WHOIS lookup for associated domains
- [ ] DNS records (A, MX, CNAME, NS, TXT) using tools like `dig` or `dnsenum`
- [ ] Passive DNS history from sources (e.g., VirusTotal, SecurityTrails)
- [ ] Search for subdomains (e.g., Sublist3r, Amass, `assetfinder`)
- [ ] Public breach databases for credential leaks (`HaveIBeenPwned`, Dehashed)
- [ ] GitHub dorking for leaked secrets and config files
- [ ] Shodan / Censys scans for exposed services

#### Active Recon
- [ ] Run port scans (e.g., `nmap`, `masscan`)
- [ ] Identify running services and versions
- [ ] HTTP fingerprinting (e.g., `whatweb`, `wappalyzer`)
- [ ] Directory fuzzing (e.g., `ffuf`, `gobuster`, `feroxbuster`)
- [ ] Subdomain bruteforcing (e.g., `amass`, `dnsenum`, `gobuster dns`)
- [ ] Screenshotting web targets (e.g., `EyeWitness`, `Aquatone`)

---

### 3. Service Enumeration

#### Web (HTTP/HTTPS)
- [ ] Identify technologies (CMS, frameworks, server type)
- [ ] Check robots.txt, sitemap.xml, `.well-known/`
- [ ] Inspect HTTP headers and cookies
- [ ] Directory and file brute force
- [ ] Parameter fuzzing (GET/POST)
- [ ] Identify API endpoints (REST/GraphQL)
- [ ] Look for exposed backups (`.bak`, `.zip`, `.tar.gz`, `.old`, `.swp`)
- [ ] Check for common sensitive files (`.env`, `config.php`, `wp-config.php`)

#### SMB (139/445)
- [ ] Enumerate shares and permissions (use `smbclient`, `enum4linux`)
- [ ] Check for anonymous login and null sessions

#### SSH (22)
- [ ] Attempt SSH brute-force on common usernames (authorized accounts only)
- [ ] Test for weak or misconfigured SSH keys

#### FTP (21)
- [ ] Check for anonymous login, writable directories, and exposed sensitive files

#### Databases (e.g., MySQL, MSSQL, PostgreSQL)
- [ ] Attempt default credentials, weak passwords, and accessible tables
- [ ] Examine database version for known exploits

---

### 4. Web Application Testing

#### Authentication & Session
- [ ] Test for weak password policies
- [ ] Check for account lockout and rate limiting
- [ ] Session fixation / session reuse
- [ ] JWT misconfigurations (if used)

#### Authorization
- [ ] IDOR / broken access control
- [ ] Role-based access bypasses

#### Input Validation
- [ ] SQL injection (classic, blind, time-based)
- [ ] XSS (stored, reflected, DOM)
- [ ] Command injection
- [ ] SSTI (template injection)
- [ ] File upload bypasses (polyglots, MIME spoofing)
- [ ] LFI/RFI

---

### 5. Privilege Escalation (If Access Gained)

#### Linux
- [ ] Check `sudo -l`
- [ ] Search for SUID binaries
- [ ] Weak file permissions (sensitive files accessible)
- [ ] Kernel exploits (check `uname -a`)

#### Windows
- [ ] Check for misconfigured services
- [ ] Look for saved credentials (e.g., in config files)
- [ ] UAC bypass possibilities
- [ ] Token privileges

---

### 6. Vulnerability Discovery

#### Misconfigurations
- [ ] Look for exposed management interfaces (e.g., `phpMyAdmin`, `Redis`, `Elasticsearch`)
- [ ] Review server misconfigurations (e.g., directory listing enabled, overly verbose error messages)
- [ ] Check for outdated software and known CVEs (use tools like `nmap --script vuln`)

#### Common Web Vulnerabilities
- [ ] Test for injection vulnerabilities (SQLi, XSS, Command Injection)
- [ ] Test for sensitive data exposure (SSNs, PII, etc.)
- [ ] Check for authorization issues (IDOR, privilege escalation paths)
- [ ] Examine CORS configurations and CSP headers for bypasses

#### Known Vulnerability Scanning
- [ ] Run vulnerability scanners like `Nessus`, `OpenVAS`, `Nexpose` (where permitted)
- [ ] Cross-reference with manual findings to avoid redundant testing

---

### 7. Service-Specific Enumeration and Checks
- **SMB (139/445)**:
  - [ ] Enumerate shares and permissions (use `smbclient`, `enum4linux`)
  - [ ] Check for anonymous login and null sessions

- **SSH (22)**:
  - [ ] Attempt SSH brute-force on common usernames (authorized accounts only)
  - [ ] Test for weak or misconfigured SSH keys

- **FTP (21)**:
  - [ ] Check for anonymous login, writable directories, and exposed sensitive files

- **Databases (e.g., MySQL, MSSQL, PostgreSQL)**:
  - [ ] Attempt default credentials, weak passwords, and accessible tables
  - [ ] Examine database version for known exploits

---

## 8. Quick Documentation
- [ ] Screenshots and Notes: Document interesting findings and commands for reporting
- [ ] Save Exploit Commands: Log successful exploits and commands used
- [ ] Clear Artifacts: Remove any temporary files, shells, or artifacts created

---

## 9. Wrap-Up
- [ ] Double-Check Access Points: Review findings for anything missed
- [ ] Take a Final Snapshot: Ensure all key discoveries are noted

---

## Abstract
**This Markdown-formatted checklist should help keep your CTF and lab engagements organized and efficient, ensuring a thorough enumeration phase without getting bogged down in excessive detail.**
